---
// Simple client-driven profile; no SSR auth logic.
export const prerender = false;
---
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <title>Perfil</title>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="stylesheet" href="/theme.css" />
    <style>
      body { margin:0; font-family:var(--font-sans,system-ui); padding:2rem clamp(1rem,2.5vw,2.4rem) 3rem; max-width:960px; }
      h1 { margin:0 0 1rem; font-size:clamp(2rem,4.5vw,2.9rem); background:linear-gradient(90deg,var(--grad-b,#7e22ce),var(--grad-a,#6366f1)); -webkit-background-clip:text; color:transparent; }
      .panel { border:1px solid rgba(255,255,255,.15); background:linear-gradient(140deg,rgba(255,255,255,.08),rgba(255,255,255,.02)); backdrop-filter:blur(24px) saturate(160%); padding:1.6rem 1.8rem 2rem; border-radius:34px; box-shadow:0 18px 60px -25px rgba(0,0,0,.6); }
      .meta { font-size:.8rem; color:#9fb3c9; }
      button { all:unset; cursor:pointer; padding:12px 20px; border-radius:18px; background:linear-gradient(90deg,var(--grad-a,#6366f1),var(--grad-b,#7e22ce)); font-size:.85rem; font-weight:600; letter-spacing:.5px; color:#fff; box-shadow:0 10px 30px -14px rgba(99,102,241,.55); }
      button:hover { transform:translateY(-2px); }
      nav { font-size:.65rem; text-transform:uppercase; letter-spacing:.5px; display:flex; gap:1rem; margin-bottom:1.2rem; }
      nav a { text-decoration:none; color:#b8cbe0; font-weight:600; }
    </style>
  </head>
  <body>
    <nav>
      <a href="/">Home</a>
      <a href="/analise">Painel</a>
      <a href="/docs/" target="_blank" rel="noopener">Docs</a>
    </nav>
    <div class="panel">
      <h1>Perfil</h1>
      <div id="profile-content" class="meta">Carregando...</div>
      <div style="margin-top:1.4rem; display:flex; gap:.8rem; flex-wrap:wrap;">
        <button id="logout-btn" type="button">Sair</button>
      </div>
    </div>
    <script type="module">
      (async ()=>{
        const root = document.getElementById('profile-content');
        const logout = document.getElementById('logout-btn');
        try {
          const auth = localStorage.getItem('la-supa-auth');
          if(!auth){ root.textContent='Não autenticado.'; return; }
          const parsed = JSON.parse(auth);
          const email = parsed.user?.email || parsed.user?.user_metadata?.email;
          root.innerHTML = '<p><strong>Email:</strong> '+(email||'—')+'</p>'+
            '<p><strong>Token expira em:</strong> '+ new Date(parsed.expires_at? parsed.expires_at*1000 : Date.now()).toLocaleString() +'</p>';
          logout.addEventListener('click', ()=>{ localStorage.removeItem('la-supa-auth'); localStorage.removeItem('la-user'); location.href='/'; });
        } catch(e){ root.textContent='Erro ao ler sessão.'; }
      })();
    </script>
  </body>
</html>
