---
title: Criando Tools
description: Aprenda como criar tools no Deco
icon: Wrench
---

import Callout from "../../../components/ui/Callout.astro";

Tools são funções discretas que agentes podem chamar para executar ações específicas como chamadas de API, consultas de banco de dados ou computações. Cada tool é essencialmente uma função com input e output definidos.

## Estrutura Básica de Tool

Toda tool precisa de:

- **`ID`**: Identificador único
- **`Description`**: O que a tool faz (ajuda a AI decidir quando usar)
- **`inputSchema` e `outputSchema`**: Schemas Zod para garantir que os dados de entrada e saída sejam validados e tipados
- **`execute`**: A lógica real. Você pode usar `context` para acessar as propriedades de input parseadas.


## Exemplo

Este exemplo mostra uma tool que envia um email via Gmail.

```typescript
 const createSendEmailTool = (env: Env) =>
  createTool({
    id: "SEND_EMAIL",
    description: "Enviar um email via Gmail",
    inputSchema: z.object({
      to: z.string().email(),
      subject: z.string(),
      body: z.string(),
    }),
    outputSchema: z.object({ success: z.boolean() }),
    execute: async ({ context }) => {
      const response = await env.GMAIL.sendEmail({
        to: context.to,
        subject: context.subject,
        body: context.body,
      });
      return { success: response.sent }; // assume que a integração retorna uma flag 'sent'
    },
  }); 
```

## Padrões de Tool

### Chamadas de API Externas

```typescript
const createWeatherTool = (env: Env) =>
  createTool({
    id: "GET_WEATHER",
    description: "Obter clima atual para uma cidade",
    inputSchema: z.object({
      city: z.string(),
    }),
    outputSchema: z.object({
      temperature: z.number(),
      condition: z.string(),
    }),
    execute: async ({ context }) => {
      const response = await fetch(
        `https://api.openweathermap.org/data/2.5/weather?q=${context.city}&appid=${env.API_KEY}`
      );
      const data = await response.json();
      return {
        temperature: data.main.temp,
        condition: data.weather[0].description,
      };
    },
  });
```

### Usando Integrações

Para serviços externos, use as integrações disponíveis no seu `env`:

```typescript
const createEmailTool = (env: Env) =>
  createTool({
    id: "SEND_EMAIL",
    description: "Enviar um email",
    inputSchema: z.object({
      to: z.string().email(),
      subject: z.string(),
      body: z.string(),
    }),
    outputSchema: z.object({ success: z.boolean() }),
    execute: async ({ context }) => {
      await env.GMAIL.SEND_EMAIL(context);
      return { success: true };
    },
  });
```

Veja o [guia de Integrações](/guides/integrations) para detalhes sobre como adicionar serviços externos.

## Operações de Banco de Dados

Todo workspace inclui um banco de dados SQLite integrado, com Drizzle ORM sendo configurado por padrão:

```typescript
const createCustomerInsertTool = (env: Env) =>
  createTool({
    id: "CUSTOMER_INSERT",
    description: "Salvar um novo cliente no banco de dados",
    inputSchema: z.object({
      name: z.string(),
      cpf: z.string(),
      city: z.string(),
      state: z.string(),
    }),
    outputSchema: z.object({ id: z.number() }),
    execute: async ({ context }) => {
      const db = await getDb(env);
      const result = await db
        .insert({
          name: customersTable.name,
          cpf: customersTable.cpf,
          city: customersTable.city,
          state: customersTable.state,
        })
        .into(customersTable)
        .returning({
          id: customersTable.id
        });

      return { id: result[0].id };
    },
  });
```

<Callout type="info">
  Cada projeto recebe um banco de dados SQLite isolado. Não há necessidade de gerenciar URLs de banco de dados ou credenciais.
</Callout>

## Registre Suas Tools

Adicione tools ao seu servidor MCP em `server/main.ts`:

```typescript
import { withRuntime } from "@deco/workers-runtime";

const { Workflow, ...runtime } = withRuntime<Env>({
  tools: [
    createCepSearchTool,
    createSendEmailTool,
    createCustomerInsertTool,
  ],
  workflows: [/* seus workflows */],
  fetch: fallbackToView("/"),
});

export { Workflow };
export default runtime;
```

## Teste Suas Tools

1. Inicie seu servidor dev: `npm run dev`
2. Copie a URL de preview
3. Adicione como integração personalizada no deco CMS (URL + `/mcp`)
4. Teste tools na interface

<Callout type="success">
  Tools aparecem automaticamente quando você adiciona a integração. Não é necessário registro manual!
</Callout>

## Melhores Práticas

### Mantenha Simples
Cada tool deve fazer uma coisa e fazê-la bem (uma chamada de API, uma consulta de banco de dados, uma computação). Isso torna as tools fáceis de reutilizar e testar.

### Use Type Safety
Os tipos gerados em `deco.gen.ts` fornecem autocompletar para integrações. Utilize definições de tipos para capturar possíveis erros de integração de API, garantindo validação em tempo de compilação dos parâmetros da tool.

### Valide Tudo
Valide inputs e outputs com schemas Zod para prevenir erros de runtime e fornecer mensagens de erro claras.