---
title: Project Structure
description: Understand how MCP servers are organized with server and view components
icon: Folder
---

import Callout from "../../components/ui/Callout.astro";

```
my-mcp-project/
├── package.json          # Root workspace scripts (dev, gen, deploy)
├── tsconfig.json         # TypeScript configuration
├── server/               # MCP Server (Cloudflare Worker)
│   ├── main.ts          # Server entry point - imports tools/workflows/views
│   ├── tools.ts         # Tool definitions
│   ├── workflows.ts     # Workflow definitions
│   ├── views.ts         # View configurations
│   ├── schema.ts        # Database schema (Drizzle ORM)
│   ├── db.ts            # Database connection helper
│   ├── drizzle.config.ts # Drizzle configuration
│   ├── deco.gen.ts      # Generated types for integrations
│   ├── wrangler.toml    # Cloudflare configuration & bindings
│   ├── drizzle/         # Migration files
│   │   ├── migrations.js
│   │   └── *.sql
│   └── package.json     # Server dependencies
└── view/                # React App (Vite + TanStack Router)
    ├── src/
    │   ├── main.tsx     # App entry point with router setup
    │   ├── routes/      # Page components (home.tsx, profile.tsx)
    │   ├── components/  # Reusable UI components
    │   ├── lib/         # RPC client and utilities
    │   └── styles.css   # Tailwind CSS styles
    ├── public/          # Static assets
    ├── vite.config.ts   # Vite configuration
    ├── components.json  # shadcn/ui configuration
    └── package.json     # Frontend dependencies
```

## Server (`/server`)

Your MCP server runs as a Cloudflare Worker and exposes tools and workflows.

### `main.ts` - Core Server Logic

The main entry point imports from separate files for organization:

```typescript
import { withRuntime } from "@deco/workers-runtime";
import { tools } from "./tools.ts";
import { workflows } from "./workflows.ts";
import { views } from "./views.ts";

const runtime = withRuntime<Env, typeof StateSchema>({
  oauth: {
    scopes: ["AI_GENERATE", "AI_GENERATE_OBJECT"],
    state: StateSchema,
  },
  views,
  workflows,
  tools,
  fetch: fallbackToView("/"), // Serves React app assets
});

export const Workflow = runtime.Workflow;
export default runtime;
```

### `tools.ts` - Tool Definitions

All your tools in one organized file:

```typescript
import { createTool, createPrivateTool } from "@deco/workers-runtime/mastra";

export const createListTodosTool = (env: Env) =>
  createTool({
    id: "LIST_TODOS",
    description: "List all todos",
    inputSchema: z.object({}),
    outputSchema: z.object({
      todos: z.array(z.object({
        id: z.number(),
        title: z.string().nullable(),
        completed: z.boolean(),
      })),
    }),
    execute: async () => {
      const db = await getDb(env);
      const todos = await db.select().from(todosTable);
      return { todos };
    },
  });

export const tools = [
  createListTodosTool,
  // ... other tools
];
```

### `workflows.ts` - Workflow Definitions

Complex multi-step processes:

```typescript
import { createWorkflow, createStepFromTool } from "@deco/workers-runtime/mastra";

const createMyWorkflow = (env: Env) => {
  const step = createStepFromTool(createMyTool(env));
  
  return createWorkflow({
    id: "MY_WORKFLOW",
    inputSchema: z.object({ name: z.string() }),
    outputSchema: z.object({ message: z.string() }),
  })
    .then(step)
    .commit();
};

export const workflows = [createMyWorkflow];
```

### `views.ts` - View Configurations

External React apps that can be installed with your MCP:

```typescript
export const views = () => [
  {
    title: "My App",
    icon: "dashboard",
    url: "https://my-app.deco.page",
  },
];
```

### `deco.gen.ts` - Generated Types

Auto-generated TypeScript types for integrations. **Never edit manually.**

```bash
# Regenerate after adding integrations
npm run gen

# Generate types for your own tools
npm run gen:self
```

### `schema.ts` - Database Schema

Define your database tables using Drizzle ORM:

```typescript
import { integer, sqliteTable, text } from "@deco/workers-runtime/drizzle";

export const todosTable = sqliteTable("todos", {
  id: integer("id").primaryKey(),
  title: text("title"),
  completed: integer("completed").default(0),
});
```

### `db.ts` - Database Helper

Database connection helper:

```typescript
import { getDatabase } from "@deco/workers-runtime/drizzle";
import type { Env } from "./main.ts";
import * as schema from "./schema.ts";

export const getDb = (env: Env) => getDatabase(env, schema);
```

### `wrangler.toml` - Configuration

Cloudflare Workers configuration:

```toml
name = "my-mcp-project"
main = "main.ts"
compatibility_date = "2025-06-17"
compatibility_flags = ["nodejs_compat"]

[assets]
directory = "./view-build"
binding = "ASSETS"

[deco]
workspace = "deco.cx"
bindings = []
enable_workflows = true

[durable_objects]
[[durable_objects.bindings]]
name = "DECO_CHAT_WORKFLOW_DO"
class_name = "Workflow"
```

<Callout type="info">
  Integrations added via `deco add` automatically update this file.
</Callout>

## View (`/view`)

The view directory contains a React app built with Vite and TanStack Router.

### App Structure

```
view/src/
├── main.tsx            # App entry point with router setup
├── routes/             # Page components
│   ├── home.tsx       # Homepage route
│   └── profile.tsx    # Profile route
├── components/         # Reusable UI components
│   ├── ui/            # shadcn/ui components
│   └── error-boundary.tsx
├── lib/               # Utilities and RPC client
│   ├── rpc.ts         # Typed RPC client for calling tools
│   ├── hooks.ts       # Custom React hooks
│   └── utils.ts       # Utility functions
└── styles.css         # Tailwind CSS styles
```

### RPC Client

Call your backend tools with full type safety:

```typescript
// view/src/lib/rpc.ts
import { createClient } from "@deco/workers-runtime/client";
import type { Env } from "../../server/deco.gen.ts";

type SelfMCP = Env["SELF"];
export const client = createClient<SelfMCP>();
```

### Route Components

Create pages using TanStack Router:

```typescript
// view/src/routes/home.tsx
import { createRoute } from "@tanstack/react-router";
import { client } from "../lib/rpc";

export default (parentRoute) => createRoute({
  getParentRoute: () => parentRoute,
  path: "/",
  component: HomePage,
});

function HomePage() {
  const handleListTodos = async () => {
    const todos = await client.tools.LIST_TODOS({});
    console.log(todos);
  };

  return (
    <div>
      <h1>My App</h1>
      <button onClick={handleListTodos}>Load Todos</button>
    </div>
  );
}
```


### What Gets Deployed

- **MCP Server**: Available at `/mcp` endpoint for AI agents
- **React App**: Public web interface for your tools
- **Database**: SQLite database with isolated workspace data  
- **Integrations**: OAuth tokens and API credentials (encrypted)

<Callout type="warning">
  React apps are public by default. Add authentication for private features.
</Callout>

